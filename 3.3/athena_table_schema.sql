CREATE EXTERNAL TABLE IF NOT EXISTS blocket_cars (
  breadcrumbs STRING,
  data_ad_id BIGINT,
  data_ad_status STRING,
  data_advertiser_account_id BIGINT,
  data_advertiser_contact_methods_mc BOOLEAN,
  data_advertiser_name STRING,
  data_advertiser_public_profile_account_created_at STRING,
  data_advertiser_public_profile_badges STRING,
  data_advertiser_public_profile_blocket_account_id BIGINT,
  data_advertiser_public_profile_display_name STRING,
  data_advertiser_public_profile_number_of_active_ads INT,
  data_advertiser_public_profile_reviews_overall_score DOUBLE,
  data_advertiser_public_profile_reviews_reviews_received_count INT,
  data_advertiser_public_profile_verified BOOLEAN,
  data_advertiser_public_profile_verified_label STRING,
  data_advertiser_type STRING,
  data_blocket_package_activated_providers STRING,
  data_blocket_package_ad_id BIGINT,
  data_blocket_package_blocket_payment_backwards_compatability STRING,
  data_blocket_package_buyers_protection_fee STRING,
  data_blocket_package_eligible_providers STRING,
  data_blocket_package_fail_code STRING,
  data_blocket_package_failure STRING,
  data_blocket_package_feature_swish BOOLEAN,
  data_blocket_package_features_is_part_of_merge BOOLEAN,
  data_blocket_package_is_in_dispute BOOLEAN,
  data_blocket_package_partner STRING,
  data_blocket_package_payment_methods STRING,
  data_blocket_package_payment_request_entrance STRING,
  data_blocket_package_payment_url STRING,
  data_blocket_package_service_data STRING,
  data_blocket_package_shipping_buy_now_entrance STRING,
  data_blocket_package_state STRING,
  data_blocket_package_transaction_dates STRING,
  data_blocket_package_urls_seller_activate STRING,
  data_body STRING,
  data_category STRING,
  data_contracts_of_sale STRING,
  data_images STRING,
  data_list_id BIGINT,
  data_list_time STRING,
  data_location STRING,
  data_map_image_url STRING,
  data_map_label STRING,
  data_map_type STRING,
  data_map_url STRING,
  data_parameter_groups STRING,
  data_price_old_value BIGINT,
  data_price_price_lowered BOOLEAN,
  data_price_suffix STRING,
  data_price_value BIGINT,
  data_saved BOOLEAN,
  data_saved_count INT,
  data_share_url STRING,
  data_state_id INT,
  data_subject STRING,
  data_type STRING,
  data_zipcode STRING,
  inventory_context_gam_api_keywords_adid STRING,
  inventory_context_gam_api_keywords_adtitle STRING,
  inventory_context_gam_api_keywords_adtype STRING,
  inventory_context_gam_api_keywords_appmode STRING,
  inventory_context_gam_api_keywords_blocket_section STRING,
  inventory_context_gam_api_keywords_brand STRING,
  inventory_context_gam_api_keywords_companyad STRING,
  inventory_context_gam_api_keywords_country STRING,
  inventory_context_gam_api_keywords_country_code STRING,
  inventory_context_gam_api_keywords_county STRING,
  inventory_context_gam_api_keywords_dealerhasownfinance STRING,
  inventory_context_gam_api_keywords_fueltype STRING,
  inventory_context_gam_api_keywords_gearbox STRING,
  inventory_context_gam_api_keywords_id STRING,
  inventory_context_gam_api_keywords_itemimage STRING,
  inventory_context_gam_api_keywords_itemsecuredthumb STRING,
  inventory_context_gam_api_keywords_itemthumb STRING,
  inventory_context_gam_api_keywords_lkf STRING,
  inventory_context_gam_api_keywords_market STRING,
  inventory_context_gam_api_keywords_mileage STRING,
  inventory_context_gam_api_keywords_model STRING,
  inventory_context_gam_api_keywords_modelyear STRING,
  inventory_context_gam_api_keywords_municipality STRING,
  inventory_context_gam_api_keywords_nmp_vertical STRING,
  inventory_context_gam_api_keywords_page STRING,
  inventory_context_gam_api_keywords_price STRING,
  inventory_context_gam_api_keywords_price_range_4 STRING,
  inventory_context_gam_api_keywords_publisher STRING,
  inventory_context_gam_api_keywords_services STRING,
  inventory_context_gam_api_keywords_subvertical STRING,
  inventory_context_gam_api_keywords_vertical STRING,
  inventory_context_gam_client_keywords_cmp_advertising STRING,
  inventory_context_gam_client_keywords_logged_in STRING,
  inventory_context_gam_client_keywords_page_gen STRING,
  inventory_context_gam_client_keywords_ppid_1 STRING,
  inventory_context_gam_client_keywords_ppid_2 STRING,
  inventory_context_gam_client_keywords_screen_height STRING,
  inventory_context_gam_client_keywords_screen_width STRING,
  inventory_context_gam_client_keywords_site_mode STRING,
  inventory_context_gam_client_keywords_supply_type STRING,
  inventory_context_gam_client_keywords_viewport_height STRING,
  inventory_context_gam_client_keywords_viewport_width STRING,
  inventory_context_gam_network_id BIGINT,
  inventory_placements STRING
)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES (
  'separatorChar' = ',',
  'quoteChar' = '"',
  'escapeChar' = '\\'
)
STORED AS TEXTFILE
LOCATION 's3://blocked-data-15/flat/'
TBLPROPERTIES ('skip.header.line.count'='1');
